<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cl.mineduc.came.apoyo_mejora_continua.mappers.AsignacionMaximaMapper">
  <resultMap id="BaseResultMap" type="cl.mineduc.came.apoyo_mejora_continua.modelo.AsignacionMaxima">
    <id column="id_asignacion_maxima" property="idAsignacionMaxima" />
    <result column="supervisores" property="supervisores" />
    <result column="foco" property="foco" />
    <result column="id_usuario_registro" property="idUsuarioRegistro" />
    <result column="fecha_registro" property="fechaRegistro" />
  </resultMap>
  
  <sql id="query">
    SELECT _am.id_asignacion_maxima, 
           _am.supervisores, 
           _am.foco, 
           _am.id_usuario_registro, 
           _am.fecha_registro
    FROM came.came_asignacion_maxima _am
  </sql>
  
  <delete id="deleteById" parameterType="java.lang.Long">
    DELETE FROM came.came_asignacion_maxima
    where id_asignacion_maxima = #{idAsignacionMaxima,jdbcType=BIGINT}
  </delete>
    
  <insert id="insert" parameterType="cl.mineduc.came.apoyo_mejora_continua.modelo.AsignacionMaxima">
    <selectKey keyColumn="id_asignacion_maxima" 
               keyProperty="idAsignacionMaxima"
			   order="BEFORE" resultType="java.lang.Long">
			(select came.next_id())
	</selectKey>
   INSERT INTO came.came_asignacion_maxima(
	id_asignacion_maxima, supervisores, foco, id_usuario_registro, fecha_registro)
	VALUES (#{idAsignacionMaxima,jdbcType=BIGINT},
            #{supervisores},
            #{foco},
            #{fechaRegistro,jdbcType=TIMESTAMP},
            #{idUsuarioRegistro,jdbcType=BIGINT});    
  </insert>
    
    <update id="updateById" parameterType="cl.mineduc.came.apoyo_mejora_continua.modelo.AsignacionMaxima">
        update came.came_asignacion_maxima
            set supervisores = #{supervisores},
                foco = #{foco},
                fecha_registro = #{fechaRegistro},
                id_usuario_registro = #{idUsuarioRegistro}         
        where id_asignacion_maxima = #{idAsignacionMaxima,jdbcType=BIGINT}
    </update>

  <select id="getAll" resultMap="BaseResultMap">
    <include refid="query"></include>
	  order by _am.id_asignacion_maxima asc
  </select>
</mapper>